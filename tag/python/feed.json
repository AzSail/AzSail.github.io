{
    "version": "https://jsonfeed.org/version/1",
    "title": "Hexo • All posts by \"python\" tag",
    "description": "",
    "home_page_url": "http://example.com",
    "items": [
        {
            "id": "http://example.com/2022/04/13/%E5%9F%BA%E4%BA%8ELinux-Anaconda%E9%83%A8%E7%BD%B2AzurLaneAutoScript/",
            "url": "http://example.com/2022/04/13/%E5%9F%BA%E4%BA%8ELinux-Anaconda%E9%83%A8%E7%BD%B2AzurLaneAutoScript/",
            "title": "基于Linux-Anaconda部署AzurLaneAutoScript",
            "date_published": "2022-04-13T01:59:00.000Z",
            "content_html": "<h1 id=\"在-Linux-上部署-AzurLaneAutoScript\"><a href=\"#在-Linux-上部署-AzurLaneAutoScript\" class=\"headerlink\" title=\"在 Linux 上部署 AzurLaneAutoScript\"></a>在 Linux 上部署 AzurLaneAutoScript</h1><h2 id=\"Anaconda相关\"><a href=\"#Anaconda相关\" class=\"headerlink\" title=\"Anaconda相关\"></a>Anaconda相关</h2><h3 id=\"下载anaconda3\"><a href=\"#下载anaconda3\" class=\"headerlink\" title=\"下载anaconda3\"></a>下载anaconda3</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://repo.continuum.io/archive/Anaconda3-5.2.0-Linux-x86_64.shanaconda</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"修改权限\"><a href=\"#修改权限\" class=\"headerlink\" title=\"修改权限\"></a>修改权限</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chmod +x Anaconda3-5.2.0-Linux-x86_64.sh</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./Anaconda3-5.2.0-Linux-x86_64.sh</span><br><span class=\"line\"># 一路yes&amp;enter</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"拉取Alas\"><a href=\"#拉取Alas\" class=\"headerlink\" title=\"拉取Alas\"></a>拉取Alas</h2><p>移动到欲安装alas目录下，git整个仓库</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd /home</span><br><span class=\"line\">git clone https://github.com/LmeSzinc/AzurLaneAutoScript.git</span><br><span class=\"line\"># 如果下载速度缓慢，可换用gitee</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"安装依赖\"><a href=\"#安装依赖\" class=\"headerlink\" title=\"安装依赖\"></a>安装依赖</h2><h3 id=\"python环境\"><a href=\"#python环境\" class=\"headerlink\" title=\"python环境\"></a>python环境</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">conda create -n alas python=3.7.6</span><br><span class=\"line\">conda activate alas</span><br><span class=\"line\">cd AzurLaneAutoScript</span><br><span class=\"line\">pip install -r requirements-in.txt -i https://pypi.tuna.tsinghua.edu.cn/simple</span><br><span class=\"line\"># 可换用其他源</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>由于某些 python 库在不同 os 下的依赖不同，直接从 requirements-in.txt 安装即可，pip会自动处理依赖。当然也可以从 requirements.txt 安装，但是需注释掉 pywin32</p>\n</blockquote>\n<h3 id=\"adb\"><a href=\"#adb\" class=\"headerlink\" title=\"adb\"></a>adb</h3><p>下载 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9kZXZlbG9wZXIuYW5kcm9pZC5jb20vc3R1ZGlvL3JlbGVhc2VzL3BsYXRmb3JtLXRvb2xz\">SDK Platform Tools for Linux</span> 并解压，将adb放在<code>/usr/bin</code>目录下</p>\n<h3 id=\"uiautomator2\"><a href=\"#uiautomator2\" class=\"headerlink\" title=\"uiautomator2\"></a>uiautomator2</h3><p>若运行 alas 后无法正常初始化 uiautomator2，可按此方法手动安装，安装过程参考 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL29wZW5hdHgvdWlhdXRvbWF0b3Iy\">uiautomator2</span></p>\n<p>运行 <code>adb connect &lt;address&gt;</code> 连接你的云手机，确保运行 <code>adb device</code> 后可以看到设备</p>\n<p>在 alas python 环境下运行 <code>python</code> 打开 python 命令行窗口，输入以下命令</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import uiautomator2 as u2</span><br><span class=\"line\"></span><br><span class=\"line\">d = u2.connect() # connect to device</span><br><span class=\"line\">print(d.info)</span><br></pre></td></tr></table></figure>\n\n<p>等待一段时间，输出类似如下内容，说明安装成功</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;&#x27;currentPackageName&#x27;: &#x27;net.oneplus.launcher&#x27;, &#x27;displayHeight&#x27;: 1920, &#x27;displayRotation&#x27;: 0, &#x27;displaySizeDpX&#x27;: 411, &#x27;displaySizeDpY&#x27;: 731, &#x27;displayWidth&#x27;: 1080, &#x27;productName&#x27;: &#x27;OnePlus5&#x27;, &#x27;</span><br><span class=\"line\">screenOn&#x27;: True, &#x27;sdkInt&#x27;: 27, &#x27;naturalOrientation&#x27;: True&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"修改deploy-yaml\"><a href=\"#修改deploy-yaml\" class=\"headerlink\" title=\"修改deploy.yaml\"></a>修改deploy.yaml</h3><p>因为Alas默认使用了Windows下的配置文件，所以我们要手动修改</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 修改gitee仓库</span><br><span class=\"line\">Deploy.Git.Repository : https://gitee.com/LmeSzinc/AzurLaneAutoScript</span><br><span class=\"line\"></span><br><span class=\"line\"># git位置</span><br><span class=\"line\">Deploy.Git.GitExecutable : /usr/bin/git</span><br><span class=\"line\"></span><br><span class=\"line\"># python位置</span><br><span class=\"line\">Deploy.Python.PythonExecutable : [Anaconda安装路径]/envs/alas/bin/python</span><br><span class=\"line\"></span><br><span class=\"line\"># adb位置</span><br><span class=\"line\">Deploy.Adb.AdbExecutable : /usr/bin/adb</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"使用-shell-脚本启动停止-alas\"><a href=\"#使用-shell-脚本启动停止-alas\" class=\"headerlink\" title=\"使用 shell 脚本启动停止 alas\"></a>使用 shell 脚本启动停止 alas</h2><p>编写脚本</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#!/bin/bash</span><br><span class=\"line\"></span><br><span class=\"line\">start()&#123;</span><br><span class=\"line\">    source &lt;conda_path&gt;/bin/activate alas # &lt;miniconda_path&gt; 替换为实际 conda 安装路径</span><br><span class=\"line\">    cd &lt;AzurLaneAutoScript_path&gt; # &lt;AzurLaneAutoScript_path&gt; 替换为 alas 路径</span><br><span class=\"line\">    git pull origin master</span><br><span class=\"line\">    nohup python gui.py &gt;/dev/nul 2&gt;&amp;1 &amp;</span><br><span class=\"line\">    echo &quot;start alas&quot;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">stop()&#123;</span><br><span class=\"line\">    kill -9 $(pgrep -f alas) </span><br><span class=\"line\">    echo &quot;kill alas&quot;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">case $1 in</span><br><span class=\"line\">    &quot;start&quot; ) start;;</span><br><span class=\"line\">    &quot;stop&quot; ) stop;;</span><br><span class=\"line\">    * ) stop;start;;</span><br><span class=\"line\">esac</span><br></pre></td></tr></table></figure>\n\n<p>将文件保存为 alas，放在<code>/usr/bin</code>，修改权限</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chmod 755 alas</span><br></pre></td></tr></table></figure>\n\n<p>可用以下命令控制 alas</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">alas start # 启动</span><br><span class=\"line\">alas stop # 停止</span><br><span class=\"line\">alas # 重启</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"遇到一些问题\"><a href=\"#遇到一些问题\" class=\"headerlink\" title=\"遇到一些问题\"></a>遇到一些问题</h2><h3 id=\"ERROR-Permission-denied\"><a href=\"#ERROR-Permission-denied\" class=\"headerlink\" title=\"ERROR:Permission denied\"></a>ERROR:Permission denied</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 权限相关问题，激活环境时用以下代码</span><br><span class=\"line\">source activate alas</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"ERROR-Conda-command-not-found\"><a href=\"#ERROR-Conda-command-not-found\" class=\"headerlink\" title=\"ERROR:Conda command not found\"></a>ERROR:Conda command not found</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 打开系统变量</span><br><span class=\"line\">vim ~/.bashrc</span><br><span class=\"line\"></span><br><span class=\"line\"># 添加系统变量</span><br><span class=\"line\">export PATH=/[path]/anaconda3/bin:$PATH # [path]为anaconda3的安装路径</span><br><span class=\"line\"></span><br><span class=\"line\">#重新加载配置</span><br><span class=\"line\">source ~/.bashrc</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"ERROR-XXX-is-not-a-trusted-or-secure-host\"><a href=\"#ERROR-XXX-is-not-a-trusted-or-secure-host\" class=\"headerlink\" title=\"ERROR:XXX is not a trusted or secure host\"></a>ERROR:XXX is not a trusted or secure host</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pip install 库包名 -i http://pypi.douban.com/simple/ --trusted-host pypi.douban.com</span><br><span class=\"line\"># 这里将pip源换成清华源、阿里源等都适用。</span><br></pre></td></tr></table></figure>\n\n<hr>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>感谢Lme大佬的 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL0xtZVN6aW5jL0F6dXJMYW5lQXV0b1NjcmlwdA==\">AzurLaneAutoScript</span> <del>MAGA 让碧蓝航线再次伟大！</del></p>\n<p>教程参考了群内大佬 <strong>Alas部署.md - freesrz</strong></p>\n<p>再一次感谢各位群大佬</p>\n",
            "tags": [
                "linux",
                "碧蓝航线",
                "Python"
            ]
        }
    ]
}